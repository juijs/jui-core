<!DOCTYPE HTML>
<html>
<head>
<META charset="UTF-8">
<title>[JUI Library] - JavaScript/Table/API</title>

<script src="../../js/base.js"></script>
<script src="../../js/util/dom.js"></script>

<script>

jui.ready([ "util.dom" ], function($) {

    // simple selector test
    console.log('==> start selector test')

    console.log('.jui', $.className("jui"));
    console.log('.jui - query selector', $.find(".jui"));
    console.log('body', $.tag("body"));
    console.log('body - query selector', $.find("body"));
    console.log("#yellow", $.id("yellow"));
    console.log("#yellow - query selector", $.find("#yellow"));
    console.log("#yellow - chain", $("#yellow"));

    console.log('==> start css test')
    // css test
    $("#yellow").css({
        position: 'absolute',
        width: '100px',
        height: '100px',
        background: '#FF0000'
    });

    console.log($("#yellow").css('background-color'), $("#yellow").css('width'));

    console.log('==> start animation test')
    var count = 0;
    var timer = setInterval(function() {
        console.log('start');
        if (count > 10) {
            clearInterval(timer);
            next();
        }

        $("#yellow").css('left', (Math.random() * 1000 % 1000) + 'px');
        count++;
    }, 1000/60);


    function next() {
        // next test case
        console.log('==> start dom manipulation(dom create, append, remove)');

        $("#yellow").append($.create('div'));
        $("#yellow").append($.create('<div class="baby">yellow baby</div>'));
        $("#yellow").append('<div class="baby2">yellow baby2</div>');
        $("#yellow").append($.create({
            style : {
                position: 'absolute',
                'border-radius' : '50%',
                background: 'black',
                width: '50px',
                height: '50px'
            }
        }));

        console.log($("<div class='love'>").append("<div class='yellow'>").appendTo("body"));

        setTimeout(function() {
            $(".love").remove();
            next2();
        }, 1000)
    }

    function next2() {
        console.log('next2 => event test ');

        $("button").on("click", function(e) {
            console.log('click', 'button', e);
            $("button").off("click");

            next3();
        });
    }

    function next3() {
        console.log('next3 --> event test 2 ');

        var $dom = $("<div />").css({
            cursor : 'pointer',
            'background' : 'yellow',
            width: '100px',
            height: '100px',
            position: 'absolute',
            right: '0px',
            top: '0px'
        }).addClass('click-layer');

        $dom.appendTo('body');

        $dom.one('click', function(e) {
           console.log('yellow layer', e);

            next4();
        });
    }

    function next4() {
        console.log('next4 ---> event delegate 1');

        $("<button>test</button>").appendTo(".click-layer");

        $(".click-layer").on('click', 'button', function (e) {
           console.log(this, e.target, 'click button in click-layer');

            $(this).append("<button>"+Math.floor(Math.random()*100)+"</button>");
        });

        $(".click-layer").on("click", $(".click-layer").children(), function(e) {
           console.log('this is children click ? ')
        });
    }
});
</script>
</head>
<body class="jui">
    <div class="event-panel">
        <button type="button">Test Button</button>
    </div>
    <div id="yellow">aaa</div>
</body>
</html>